use angstrom_types::primitive::AngstromAddressConfig;
use clap::Parser;
use replay::{ReplayCli, init_tracing};
use reth_provider::noop::NoopProvider;
use telemetry::blocklog::BlockLog;
use testing_tools::{controllers::enviroments::AngstromTestnet, types::config::ReplayConfig};

const LOG_DATA: &str = "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";

fn read_log_from_stdin() -> BlockLog {
    // let mut buf = String::new();
    // let mut handle = stdin().lock();
    // handle.read_to_string(&mut buf).unwrap();
    BlockLog::from_deflate_base64_str(LOG_DATA)
}

fn main() {
    init_tracing(2);

    // set the proper address and domain
    AngstromAddressConfig::INTERNAL_TESTNET.try_init();

    let cli = ReplayCli::parse();
    let raw_log = read_log_from_stdin();
    let target_block = raw_log.blocknum().saturating_sub(71);
    tracing::info!(target_block, log_block = raw_log.blocknum(), "Loaded and registered log");
    let initial_state = cli.load_pool_keys().unwrap();
    let config = ReplayConfig::new(
        initial_state,
        cli.testnet_replay,
        cli.eth_fork_url.clone(),
        target_block
    );
    // let node_config = TestingNodeConfig::new(1, config.clone(), 10);
    reth::CliRunner::try_default_runtime()
        .unwrap()
        .run_command_until_exit(async move |ctx| -> eyre::Result<()> {
            // let ex = ctx.task_executor;
            // let (replay_log, provider, initial_state) =
            //     build_log_and_provider(node_config, raw_log, ex.clone()).await?;
            // // Replay our BlockLog
            // replay_stuff(provider, ex, replay_log, initial_state).await?;

            let (net, state_rx) = AngstromTestnet::spawn_replay(
                NoopProvider::mainnet(),
                config,
                ctx.task_executor.clone()
            )
            .await?;
            net.replay_stuff(ctx.task_executor, raw_log, state_rx)
                .await?;
            Ok(())
        })
        .unwrap();
}
