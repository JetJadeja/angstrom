use angstrom_types::primitive::AngstromAddressConfig;
use clap::Parser;
use replay::{ReplayCli, init_tracing};
use reth_provider::noop::NoopProvider;
use telemetry::blocklog::BlockLog;
use testing_tools::{controllers::enviroments::AngstromTestnet, types::config::ReplayConfig};

const LOG_DATA: &str = "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";

fn read_log_from_stdin() -> BlockLog {
    // let mut buf = String::new();
    // let mut handle = stdin().lock();
    // handle.read_to_string(&mut buf).unwrap();
    BlockLog::from_deflate_base64_str(LOG_DATA)
}

fn main() {
    init_tracing(2);

    let cli = ReplayCli::parse();

    if cli.testnet_replay {
        // Setup the testnet addresses if we are doing a testnet run
        AngstromAddressConfig::INTERNAL_TESTNET.try_init();
    }
    let raw_log = read_log_from_stdin();
    let target_block = raw_log.blocknum().saturating_sub(71);
    tracing::info!(target_block, log_block = raw_log.blocknum(), "Loaded and registered log");
    let initial_state = cli.load_pool_keys().unwrap();
    let config = ReplayConfig::new(
        initial_state,
        cli.testnet_replay,
        cli.eth_fork_url.clone(),
        target_block
    );
    // let node_config = TestingNodeConfig::new(1, config.clone(), 10);
    reth::CliRunner::try_default_runtime()
        .unwrap()
        .run_command_until_exit(async move |ctx| -> eyre::Result<()> {
            let (net, state_rx) = AngstromTestnet::spawn_replay(
                NoopProvider::mainnet(),
                config,
                ctx.task_executor.clone(),
                raw_log.gas_price_snapshot().cloned()
            )
            .await?;
            net.replay_stuff(ctx.task_executor, raw_log, state_rx)
                .await?;
            Ok(())
        })
        .unwrap();
}
